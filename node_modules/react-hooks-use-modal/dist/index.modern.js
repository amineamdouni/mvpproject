import e,{Fragment as t,useEffect as n,useRef as r,useMemo as o,createContext as i,useContext as l,useState as a,useCallback as c}from"react";import{createPortal as u}from"react-dom";import{disableBodyScroll as s,enableBodyScroll as d,clearAllBodyScrollLocks as p}from"body-scroll-lock";import{createFocusTrap as f}from"focus-trap";var m={position:"fixed",top:0,left:0,bottom:0,right:0,display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},v=function(t){return e.createElement("div",{style:m},t.children)},h={position:"fixed",top:0,left:0,bottom:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.5)"},O=function(){return e.createElement("div",{style:h})},b=function(n){return e.createElement(t,null,n.children)};function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g.apply(this,arguments)}var y=function(t){var i=t.children,l=t.isOpen,a=t.close,c=t.elementId,m=void 0===c?"root":c,v=t.title,h=t.description,O=t.preventScroll,b=t.focusTrapOptions,y=t.components,E=t.additionalProps,w=r(null);return function(e,t,r){n(function(){if(t&&null!==e.current){var n=f(e.current,g({fallbackFocus:e.current},r));return n.activate(),setTimeout(function(){document.activeElement===e.current&&console.warn("[react-hooks-use-modal]: Since there were no focusable elements in the modal, the initial focus was on the containing element.\n  WAI-ARIA 1.1 states that there should be at least one focusable element in the modal.\n  https://www.w3.org/TR/wai-aria-1.1/#dialog")},100),function(){n.deactivate()}}},[r,t,e])}(w,l,o(function(){return g({onDeactivate:a,clickOutsideDeactivates:!0},b)},[a,b])),function(e,t,r){n(function(){if(null!==e.current)return r?(t?s(e.current,{reserveScrollBarGap:!0}):d(e.current),function(){p()}):void 0},[t,r,e])}(w,l,O),!1===l?null:u(e.createElement(y.Wrapper,null,e.createElement(y.Overlay,null),e.createElement("div",{ref:w,role:"dialog","aria-modal":"true",tabIndex:-1,style:{position:"relative"}},e.createElement(y.Modal,{title:v,description:h,close:a,additionalProps:E},i))),document.getElementById(m))},E=i({}),w=["children"],I=function(t){var n=t.children,r=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(o[n]=e[n]);return o}(t,w);return e.createElement(E.Provider,{value:r},n)},x={initialValue:!1,preventScroll:!1,focusTrapOptions:{},components:{}},k=function(t,n){var r,i,u;void 0===t&&(t="root");var s=l(E),d=o(function(){return Object.assign({},x,s,n)},[s,n]),p=d.preventScroll,f=d.focusTrapOptions,m=d.components,h=a(d.initialValue),g=h[0],w=h[1],I=c(function(){w(!0)},[w]),k=c(function(){w(!1)},[w]),P=null!=(r=m.Wrapper)?r:v,S=null!=(i=m.Overlay)?i:O,T=null!=(u=m.Modal)?u:b;return[c(function(n){return e.createElement(y,{isOpen:g,close:k,elementId:t,title:n.title,description:n.description,preventScroll:p,focusTrapOptions:f,components:{Modal:T,Overlay:S,Wrapper:P},additionalProps:n.additionalProps},n.children)},[T,S,P,k,t,f,g,p]),I,k,g]};export{I as ModalProvider,k as useModal};
